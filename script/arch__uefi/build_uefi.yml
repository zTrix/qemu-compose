name: arch__uefi
args:
  - # basic
    smp: '2'
    m: 4G
    bios: /usr/share/ovmf/x64/OVMF.4m.fd    # enable UEFI bios
  # - drive: file={PWD}/arch.qcow2,if=virtio,cache=writeback,discard=ignore,format=qcow2
  - drive: media=cdrom,file={PWD}/archlinux-2025.06.01-x86_64.iso,readonly=on
  - boot: once=d
  - netdev: user,id=user.0,hostfwd=tcp:127.0.0.1:7022-:22
  - device: virtio-net,netdev=user.0
boot_commands:
  - wait: 0.1
  - read_until: 'Arch Linux install medium'
  - write: "e"
  - wait: 0.1
  - write: ["*", "key_right", 60]
  - wait: 0.1
  - write: " console=ttyS0\r\n"
  - read_until: "\r\narchiso login: "
  - write: "root\r\n"
pre_script:
  - qemu_img create -f 
post_script:
  - test
